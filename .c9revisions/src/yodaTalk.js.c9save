{"ts":1379208735027,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"//var window = this;\r\n//global $\r\n\r\n//\"use strict\";\r\n\r\nvar root = this;\r\n\r\n$(window.document).ready(function () {\r\n\r\n    var YodaTalk = function (translator, translationStack) {\r\n        // translator Class\r\n        this.translator = translator;\r\n        // html elements model & controller\r\n        this.translationStack = translationStack;\r\n    };\r\n    \r\n    // Initial YodaTalk - for events\r\n    var YT = new YodaTalk(\r\n        root.YodaCurrentLanguageSet.getCurrentTranslator(),\r\n        new root.YodaStack({\r\n            items: \".element\", \r\n            addItems: \".add_element\"\r\n        })\r\n    );\r\n        \r\n    $(\".change_translation\").click(function () {\r\n        \r\n        $(\".change_translation.selectedTranslation\").removeClass(\"selectedTranslation\");\r\n        \r\n        $(this).addClass(\"selectedTranslation\");\r\n        \r\n        var translator = $(this).data(\"value\");\r\n        \r\n        if (translator === \"bing\") {\r\n            root.YodaCurrentLanguageSet.setLanguageSet(\"bing\");\r\n        } else if (translator === \"sangdol\") {\r\n            root.YodaCurrentLanguageSet.setLanguageSet(\"sangdol\");   \r\n        } else if (translator === \"stichoza\") {\r\n            root.YodaCurrentLanguageSet.setLanguageSet(\"stichoza\");   \r\n        } else if (translator === \"mymem\") {\r\n            root.YodaCurrentLanguageSet.setLanguageSet(\"mymem\");   \r\n        }\r\n        \r\n        YT.translationStack.restart();\r\n    });\r\n    \r\n    \r\n    $(\".translate_button\").click(function () {\r\n        YT = new YodaTalk(\r\n            root.YodaCurrentLanguageSet.getCurrentTranslator(), \r\n            new root.YodaStack({\r\n                items: \".element\", \r\n                addItems: \".add_element\"\r\n            })\r\n        );\r\n        initiateTranslationSequence(YT);\r\n    });\r\n   \r\n  \r\n    //todo: remove global variables from code\r\n    function obtainAjaxPromise(someResult, YodaTalk) {\r\n      \r\n        // text, from, to\r\n        YodaTalk.translator.setTranslations.apply(\r\n            undefined, \r\n            YodaTalk.translationStack.getCurrentStep()    \r\n        );\r\n      \r\n        var promise = Q\r\n            .when( YodaTalk.translator.ajaxCall());\r\n          \r\n        var textFillInPromise = promise.then(function (result) {\r\n          \r\n            var resultObject = YodaTalk.translator.getResultObj(result);\r\n            console.log(\"RESULT>>>:\", resultObject);\r\n            YodaTalk.translationStack.pushTranslations(resultObject);\r\n            var currentResult = YodaTalk.translationStack.getCurrentResult();\r\n          \r\n            // returns a promise\r\n            return YodaTalk.translationStack.setNextText(currentResult);\r\n          \r\n        }, function (error) {\r\n            console.log(\"YodaTalk: Error: \", error);\r\n        }, function (progress) {\r\n            console.log(\"YodaTalk: Progress: \", progress);\r\n        });\r\n          \r\n        return textFillInPromise.then(function(result) {\r\n            console.log(\"YodaTalk: Result: \",result);\r\n        }, function (error) {\r\n            console.log(\"YodaTalk: Error: \", error);\r\n        }, function (progress) {\r\n            \r\n            var YodaProgressElement = YodaTalk.translationStack.getCurrent().progress;\r\n            if (!YodaProgressElement || !YodaProgressElement.progress) return;\r\n            YodaProgressElement.progress(parseFloat(progress));\r\n            if (YodaProgressElement.isDone()) YodaTalk.translationStack.deferred.resolve();\r\n            //console.log(\"Progress %:\", progress);\r\n      });\r\n    }\r\n\r\n    function initiateTranslationSequence (YodaTalk) {\r\n        \r\n        $(\".toggle_elements\").on(\"click\", function () {\r\n            YodaTalk.translationStack.toggleMiddleElements(\"show\");\r\n        });\r\n      \r\n        function processItem(prevResult) {\r\n            return obtainAjaxPromise(prevResult, YodaTalk);\r\n        }\r\n      \r\n        var nextTick = Q.when(),\r\n            length = YodaTalk.translationStack.getStackSize();\r\n        \r\n        for (var i = length; i > 1; i --) {\r\n            nextTick = nextTick.then( processItem );\r\n        }\r\n      \r\n        // After all translations happened\r\n        nextTick.then(function () {\r\n            YodaTalk.translationStack.toggleMiddleElements(\"hide\");\r\n        });\r\n        \r\n        // Scroll to the top of translation stack\r\n        nextTick.then(function () {\r\n           $('html, body').animate({\r\n                scrollTop: YodaTalk.translationStack.stack[0].textElement.offset().top - 150\r\n            }, 1500);\r\n        });\r\n      \r\n        nextTick.fin(function(result) {\r\n            console.log(\"YodaTalk: Result:\", result); \r\n        }, function (error) {\r\n            console.log(\"YodaTalk: Error:\", error);\r\n        });\r\n        \r\n    }\r\n    \r\n});"]],"start1":0,"start2":0,"length1":0,"length2":4718}]],"length":4718}
{"contributors":[],"silentsave":false,"ts":1379382903766,"patch":[[{"diffs":[[0,"ltObj(result);\r\n"],[1,"            \r\n"],[0,"            cons"]],"start1":2298,"start2":2298,"length1":32,"length2":46},{"diffs":[[0,"resultObject);\r\n"],[1,"            \r\n"],[0,"            Yoda"]],"start1":2366,"start2":2366,"length1":32,"length2":46},{"diffs":[[0,"    "],[-1,"var currentResult = YodaTalk.translationStack.getCurrentResult();\r\n          "],[0,"\r\n  "]],"start1":2475,"start2":2475,"length1":85,"length2":8},{"diffs":[[0,"ext("],[-1,"currentResult"],[0,");\r\n"]],"start1":2568,"start2":2568,"length1":21,"length2":8},{"diffs":[[0,"YodaTalk: Error:"],[1," 2.2"],[0," \", error);\r\n   "]],"start1":2644,"start2":2644,"length1":32,"length2":36},{"diffs":[[0,"ogress: "],[1,"2.2"],[0,"\", progr"]],"start1":2748,"start2":2748,"length1":16,"length2":19},{"diffs":[[0,"   });\r\n        "],[1,"\r\n      "],[0,"  \r\n        retu"]],"start1":2779,"start2":2779,"length1":32,"length2":40},{"diffs":[[0,"Result: "],[1,"2.3"],[0,"\","],[1," "],[0,"result);"]],"start1":2900,"start2":2900,"length1":18,"length2":22},{"diffs":[[0,": Error:"],[1," 2.3"],[0," \", erro"]],"start1":2988,"start2":2988,"length1":16,"length2":20},{"diffs":[[0,"\r\n            \r\n"],[1,"            // Get progress bar element\r\n"],[0,"            var "]],"start1":3045,"start2":3045,"length1":32,"length2":73},{"diffs":[[0,"gress;\r\n"],[1,"            \r\n            // If not defined, return false\r\n"],[0,"        "]],"start1":3182,"start2":3182,"length1":16,"length2":75},{"diffs":[[0,") return"],[1," false"],[0,";\r\n     "]],"start1":3318,"start2":3318,"length1":16,"length2":22},{"diffs":[[0,"    "],[-1,"YodaProgressElement.progress(parseFloat(progress));"],[1,"\r\n            // Try to progress with 0.00 - 1.00 values\r\n            YodaProgressElement.progress(parseFloat(progress).toFixed(2));\r\n            \r\n            // When progress bar returns true for isDone?, resolve a deferred object"],[0,"\r\n  "]],"start1":3343,"start2":3343,"length1":59,"length2":240},{"diffs":[[0,"resolve();\r\n"],[1,"            \r\n"],[0,"            "]],"start1":3662,"start2":3662,"length1":24,"length2":38},{"diffs":[[0,"e();\r\n        \r\n"],[1,"        // Process all translations that are in the stack\r\n"],[0,"        for (var"]],"start1":4189,"start2":4189,"length1":32,"length2":91},{"diffs":[[0,"       }\r\n      "],[-1,""],[0,""],[1,"  \r\n        nextTick."],[0,"\r\n        // Aft"]],"start1":4364,"start2":4364,"length1":32,"length2":53},{"diffs":[[0,"ed\r\n        "],[-1,"nextTick."],[0,""],[1,""],[0,"then(functio"]],"start1":4443,"start2":4443,"length1":33,"length2":24},{"diffs":[[0,"\r\n        })"],[-1,";\r\n        "],[1,"."],[0,"\r\n        //"]],"start1":4542,"start2":4542,"length1":35,"length2":25},{"diffs":[[0,"        "],[-1,"nextTick."],[0,""],[1,""],[0,"then(fun"]],"start1":4608,"start2":4608,"length1":25,"length2":16},{"diffs":[[0,"\r\n        })"],[-1,";"],[1,"."],[0,"\r\n      "],[1,"  // Finalize sequence"],[0,"\r\n        ne"]],"start1":4789,"start2":4789,"length1":33,"length2":55},{"diffs":[[0,"        "],[-1,"nextTick."],[0,"fin(func"]],"start1":4834,"start2":4834,"length1":25,"length2":16},{"diffs":[[0," Result:"],[1," 3"],[0,"\", resul"]],"start1":4900,"start2":4900,"length1":16,"length2":18},{"diffs":[[0,": Error:"],[1," 3"],[0,"\", error"]],"start1":4988,"start2":4988,"length1":16,"length2":18}]],"length":5049,"saved":false}
{"ts":1379393943663,"patch":[[{"diffs":[[0,"or: "],[-1,"2.2 "],[0,""],[1,""],[0,"\", e"]],"start1":2657,"start2":2657,"length1":12,"length2":8},{"diffs":[[0,"ss: "],[-1,"2.2"],[0,""],[1,""],[0,"\", p"]],"start1":2748,"start2":2748,"length1":11,"length2":8},{"diffs":[[0," {\r\n            "],[1,"//"],[0,"console.log(\"Yod"]],"start1":2854,"start2":2854,"length1":32,"length2":34},{"diffs":[[0,"Result: "],[-1,"2.3"],[0,"\", resul"]],"start1":2895,"start2":2895,"length1":19,"length2":16},{"diffs":[[0,"ror:"],[-1," 2.3"],[0," \", "]],"start1":2984,"start2":2984,"length1":12,"length2":8},{"diffs":[[0," {\r\n            "],[1,"//"],[0,"console.log(\"Yod"]],"start1":4850,"start2":4850,"length1":32,"length2":34},{"diffs":[[0,"Result: "],[-1,"3"],[0,"\", resul"]],"start1":4891,"start2":4891,"length1":17,"length2":16},{"diffs":[[0,"or: "],[-1,"3"],[0,"\", e"]],"start1":4982,"start2":4982,"length1":9,"length2":8}]],"length":5037,"saved":false}
